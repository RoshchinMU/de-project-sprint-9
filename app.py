import uuid




# print(uuid.uuid5(namespace=uuid.UUID('7f288a2e-0ad0-4039-8e59-6c9838d87307'), name=str("суп")))



# print(uuid.UUID('7f288a2e-0ad0-4039-1111-6c9838d87307'))



final = [
  {
    "h_user_pk": "2de94477-8cfb-5b27-a174-d763aa4e861e",
    "h_order_pk": "23e7ac17-67bb-5c0c-ad52-03c3ec5cfc74",
    "h_restaurant_pk": "c9f48c4f-8d0b-569b-a8de-8a4e67d2d129",
    "h_product_pk": "946839ed-a440-5881-8afb-44e765bab370",
    "product_id": "7bbd451a9ccb03e2f52badc9",
    "product_price": 595,
    "product_quantity": 4,
    "product_name": "Фиш Карри",
    "h_category_pk": "0dd20aff-3946-5296-a371-d5fbe8977de8",
    "category_name": "Основные блюда",
    "hk_order_product_pk": "7fa427a7-567c-5275-be4b-a06e45050b83",
    "hk_order_user_pk": "db79c6f0-bd76-50af-aaed-fee919a76f97",
    "hk_product_category_pk": "9f3f1fda-efdc-50a2-b050-bec18f47142b",
    "hk_product_restaurant_pk": "1d32c0a0-fe1f-5680-8ab5-e83097ad5fea"
  },
  {
    "h_user_pk": "2de94477-8cfb-5b27-a174-d763aa4e861e",
    "h_order_pk": "23e7ac17-67bb-5c0c-ad52-03c3ec5cfc74",
    "h_restaurant_pk": "c9f48c4f-8d0b-569b-a8de-8a4e67d2d129",
    "h_product_pk": "75c373ab-c4ef-58c8-ae41-e76b3ce9ada1",
    "product_id": "b551423ca4daabd9e219ee47",
    "product_price": 299,
    "product_quantity": 1,
    "product_name": "Томатный суп",
    "h_category_pk": "5f2bd497-da00-5ac4-b4a7-3f00c6551edc",
    "category_name": "Супы",
    "hk_order_product_pk": "ae5b775e-a972-5adf-a72e-6ad02a738d6b",
    "hk_order_user_pk": "db79c6f0-bd76-50af-aaed-fee919a76f97",
    "hk_product_category_pk": "71d1ffd2-c264-5bdc-8e71-0e73d6099d83",
    "hk_product_restaurant_pk": "f5272e57-a396-57cb-b157-a611f40e3658"
  },
  {
    "h_user_pk": "2de94477-8cfb-5b27-a174-d763aa4e861e",
    "h_order_pk": "23e7ac17-67bb-5c0c-ad52-03c3ec5cfc74",
    "h_restaurant_pk": "c9f48c4f-8d0b-569b-a8de-8a4e67d2d129",
    "h_product_pk": "ba875535-0d6d-5ff5-a251-55fa44b80b6c",
    "product_id": "3f7848ea94b146dedf030c2a",
    "product_price": 499,
    "product_quantity": 1,
    "product_name": "Дал Макхни",
    "h_category_pk": "0dd20aff-3946-5296-a371-d5fbe8977de8",
    "category_name": "Основные блюда",
    "hk_order_product_pk": "bab8a175-320d-5304-9e78-cfa50b7e5cd6",
    "hk_order_user_pk": "db79c6f0-bd76-50af-aaed-fee919a76f97",
    "hk_product_category_pk": "848243db-13af-5063-ad6e-e5d272ad6d46",
    "hk_product_restaurant_pk": "731d4375-fc23-5a5a-a695-9b54aea0adc8"
  },
  {
    "h_user_pk": "2de94477-8cfb-5b27-a174-d763aa4e861e",
    "h_order_pk": "23e7ac17-67bb-5c0c-ad52-03c3ec5cfc74",
    "h_restaurant_pk": "c9f48c4f-8d0b-569b-a8de-8a4e67d2d129",
    "h_product_pk": "cab2808a-7fb7-5fb9-a3e0-bc41a3060c9c",
    "product_id": "7105441f860b1124a3a24fe9",
    "product_price": 250,
    "product_quantity": 5,
    "product_name": "Банана Ласси",
    "h_category_pk": "7cf18c31-5257-56e6-8f05-b125160e2e85",
    "category_name": "Напитки",
    "hk_order_product_pk": "c16bad98-ed4b-5b15-961a-1c90d34303cd",
    "hk_order_user_pk": "db79c6f0-bd76-50af-aaed-fee919a76f97",
    "hk_product_category_pk": "f5a5ba7c-ec32-5aaf-92ee-21eba48a9379",
    "hk_product_restaurant_pk": "2bc42d96-82f0-5f3b-a702-b7d8afa94da0"
  },
  {
    "h_user_pk": "2de94477-8cfb-5b27-a174-d763aa4e861e",
    "h_order_pk": "23e7ac17-67bb-5c0c-ad52-03c3ec5cfc74",
    "h_restaurant_pk": "c9f48c4f-8d0b-569b-a8de-8a4e67d2d129",
    "h_product_pk": "ec34ac0b-e2a0-5cbc-b055-dae6c1b8f5c6",
    "product_id": "413c484db69df84af89cab35",
    "product_price": 399,
    "product_quantity": 4,
    "product_name": "Чили Машрум",
    "h_category_pk": "96927a73-3397-50a0-8021-3417b0869c60",
    "category_name": "Закуски",
    "hk_order_product_pk": "f0f309bc-5386-5481-9167-e65acd1559f1",
    "hk_order_user_pk": "db79c6f0-bd76-50af-aaed-fee919a76f97",
    "hk_product_category_pk": "d8dc7e87-7d75-54a0-8354-f0d8a78d9116",
    "hk_product_restaurant_pk": "aeea2103-b508-5c90-a091-bd9b647afa6a"
  }
]

# print(final)

d = dict()

print({"user_id": "123",
       "data_cdm": [({"product_id": item["h_product_pk"],
                      "product_name": item["product_name"],
                      "category_id": item["h_category_pk"],
                      "category_name": item["category_name"],
                      "order_cnt": item["product_quantity"],}) for item in final]})
                



# d = dict()
# for p in final:
#     d["user_id"] = p["h_user_pk"]
#     d["h_category_pk"] = p["h_category_pk"]
#     print(p["h_user_pk"], p["product_quantity"], p["h_category_pk"], p["category_name"], p["h_product_pk"], p["product_name"])
# final = {}
# for d in dict1:
#     for k in d.keys():
#         final[k] = final.get(k,0) + d[k]

# print(sum(item["product_quantity"] for item in final))

# print(sum(d["v"] for item in d))
# print({"aa": 123, "data": d})